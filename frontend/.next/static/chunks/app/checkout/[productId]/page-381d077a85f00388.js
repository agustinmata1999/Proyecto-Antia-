(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[490],{4296:function(e,t,s){Promise.resolve().then(s.bind(s,2979))},9763:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),l=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{color:c="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:d,className:u="",children:m,...h}=s;return(0,a.createElement)("svg",{ref:l,...r,width:i,height:i,stroke:c,strokeWidth:d?24*Number(o)/Number(i):o,className:["lucide","lucide-".concat(n(e)),u].join(" "),...h},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])});return s.displayName="".concat(e),s}},5863:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2979:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(7437),r=s(2265),n=s(9376),l=s(1837),c=s(5863),i=s(9763);let o=(0,i.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),d=(0,i.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),u=(0,i.Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),m=(0,i.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function h(){let e=(0,n.useParams)(),t=(0,n.useSearchParams)(),s=e.productId,i=t.get("telegram_user_id")||"",h=t.get("telegram_username")||"",[x,g]=(0,r.useState)(null),[p,b]=(0,r.useState)(!0),[y,f]=(0,r.useState)(!1),[j,v]=(0,r.useState)(""),[N,w]=(0,r.useState)("guest"),[k,C]=(0,r.useState)(""),[S,M]=(0,r.useState)(""),[P,D]=(0,r.useState)(!1),[E,z]=(0,r.useState)(!1),[L,A]=(0,r.useState)(!1),[Z,_]=(0,r.useState)(""),[T,F]=(0,r.useState)(""),[I,U]=(0,r.useState)(null),[O,q]=(0,r.useState)("card");(0,r.useEffect)(()=>{B(),R()},[s]);let R=async()=>{try{var e;let t=await l.hi.get("/checkout/detect-gateway");U(t.data),(null===(e=t.data.availableMethods)||void 0===e?void 0:e.length)>0&&q(t.data.availableMethods[0])}catch(e){console.error("Error detecting gateway:",e),U({gateway:"stripe",geo:{country:"XX",countryName:"Unknown",isSpain:!1},availableMethods:["card"]})}},B=async()=>{try{let e=await l.hi.get("/checkout/product/".concat(s));g(e.data)}catch(e){v("Producto no encontrado o no disponible")}finally{b(!1)}},V=(e,t)=>new Intl.NumberFormat("es-ES",{style:"currency",currency:t}).format(e/100),$=async()=>{if(v(""),!k){v("El correo electr\xf3nico es obligatorio");return}if(!P||!E){v("Debes aceptar los t\xe9rminos y confirmar que eres mayor de edad");return}if("register"===N){if(!Z||!T){v("La contrase\xf1a es obligatoria para registrarse");return}if(Z!==T){v("Las contrase\xf1as no coinciden");return}if(Z.length<8){v("La contrase\xf1a debe tener al menos 8 caracteres");return}}f(!0);try{let e=await l.hi.post("/checkout/session",{productId:s,originUrl:window.location.origin,isGuest:"guest"===N,email:k,phone:S||void 0,telegramUserId:i||void 0,telegramUsername:h||void 0});e.data.url&&(window.location.href=e.data.url)}catch(s){var e,t;v((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Error al procesar el pago"),f(!1)}},W=async()=>{if(v(""),!k){v("El correo electr\xf3nico es obligatorio");return}if(!P||!E){v("Debes aceptar los t\xe9rminos y confirmar que eres mayor de edad");return}f(!0);try{let e=await l.hi.post("/checkout/test-purchase",{productId:s,email:k,phone:S||void 0,telegramUserId:i||void 0,telegramUsername:h||void 0});e.data.success&&(window.location.href="/checkout/success?order_id=".concat(e.data.orderId))}catch(s){var e,t;v((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Error al simular el pago"),f(!1)}};return p?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}):j&&!x?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[(0,a.jsx)("p",{className:"text-red-600 mb-4",children:j}),(0,a.jsx)("a",{href:"/",className:"text-blue-600 hover:underline",children:"Volver al inicio"})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:(0,a.jsxs)("div",{className:"max-w-md mx-auto",children:[I&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded-xl text-center text-sm ".concat(I.geo.isSpain?"bg-yellow-50 border border-yellow-200 text-yellow-800":"bg-blue-50 border border-blue-200 text-blue-800"),children:I.geo.isSpain?(0,a.jsxs)(a.Fragment,{children:["\uD83C\uDDEA\uD83C\uDDF8 Pago desde Espa\xf1a - Disponible: Tarjeta ",I.availableMethods.includes("bizum")&&"+ Bizum"]}):(0,a.jsxs)(a.Fragment,{children:["\uD83C\uDF0D Pago desde ",I.geo.countryName," - Tarjeta de cr\xe9dito/d\xe9bito"]})}),(0,a.jsxs)("div",{className:"bg-white rounded-t-2xl p-6 border-b",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-center text-gray-900",children:"Antia"}),(0,a.jsxs)("div",{className:"text-center mt-4",children:[(0,a.jsx)("p",{className:"text-4xl font-bold text-gray-900",children:x&&V(x.priceCents,x.currency)}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:null==x?void 0:x.title})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-b-2xl p-6 shadow-lg",children:[(0,a.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,a.jsxs)("label",{className:"flex items-center p-4 border rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("input",{type:"radio",name:"checkoutMode",value:"guest",checked:"guest"===N,onChange:()=>w("guest"),className:"w-4 h-4 text-blue-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"Pagar como invitado"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Solo necesitas tu email para acceder"})]})]}),(0,a.jsxs)("label",{className:"flex items-center p-4 border rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("input",{type:"radio",name:"checkoutMode",value:"register",checked:"register"===N,onChange:()=>w("register"),className:"w-4 h-4 text-blue-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"Registrarme para futuras compras"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Crea una cuenta para gestionar tus suscripciones"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo electr\xf3nico *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"email",value:k,onChange:e=>C(e.target.value),placeholder:"tu@email.com",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tel\xe9fono (opcional)"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"tel",value:S,onChange:e=>M(e.target.value),placeholder:"+34 600 000 000",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(null==I?void 0:I.geo.isSpain)&&I.availableMethods.length>1&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"M\xe9todo de pago"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("label",{className:"flex items-center justify-center p-4 border-2 rounded-xl cursor-pointer transition-all ".concat("card"===O?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",value:"card",checked:"card"===O,onChange:()=>q("card"),className:"sr-only"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(u,{className:"w-6 h-6 mx-auto mb-1"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Tarjeta"})]})]}),(0,a.jsxs)("label",{className:"flex items-center justify-center p-4 border-2 rounded-xl cursor-pointer transition-all ".concat("bizum"===O?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",value:"bizum",checked:"bizum"===O,onChange:()=>q("bizum"),className:"sr-only"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCF1"}),(0,a.jsx)("span",{className:"text-sm font-medium block",children:"Bizum"})]})]})]})]}),"register"===N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-xl mb-4",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Nota:"})," Al registrarte, podr\xe1s gestionar tus suscripciones y ver tu historial de compras."]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrase\xf1a *"}),(0,a.jsx)("input",{type:"password",value:Z,onChange:e=>_(e.target.value),placeholder:"M\xednimo 8 caracteres",className:"w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar contrase\xf1a *"}),(0,a.jsx)("input",{type:"password",value:T,onChange:e=>F(e.target.value),placeholder:"Repite la contrase\xf1a",className:"w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3 mt-6",children:[(0,a.jsxs)("label",{className:"flex items-start cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:E,onChange:e=>z(e.target.checked),className:"w-4 h-4 mt-1 text-blue-600 rounded"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Confirmo que soy mayor de 18 a\xf1os *"})]}),(0,a.jsxs)("label",{className:"flex items-start cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:P,onChange:e=>D(e.target.checked),className:"w-4 h-4 mt-1 text-blue-600 rounded"}),(0,a.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:["Acepto los"," ",(0,a.jsx)("a",{href:"/terms",className:"text-blue-600 hover:underline",children:"T\xe9rminos de Uso"})," ","y la"," ",(0,a.jsx)("a",{href:"/privacy",className:"text-blue-600 hover:underline",children:"Pol\xedtica de Privacidad"})," *"]})]}),(0,a.jsxs)("label",{className:"flex items-start cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:L,onChange:e=>A(e.target.checked),className:"w-4 h-4 mt-1 text-blue-600 rounded"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Acepto recibir comunicaciones sobre novedades y promociones"})]})]}),j&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-xl",children:(0,a.jsx)("p",{className:"text-sm text-red-600",children:j})}),(0,a.jsxs)("div",{className:"space-y-3 mt-6",children:[(0,a.jsx)("button",{onClick:$,disabled:y,className:"w-full bg-black text-white py-4 rounded-xl font-medium hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:y?(0,a.jsx)(c.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{className:"w-5 h-5"}),"Proceder al pago con Stripe"]})}),(0,a.jsx)("button",{onClick:W,disabled:y,className:"w-full bg-green-600 text-white py-4 rounded-xl font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:y?(0,a.jsx)(c.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(a.Fragment,{children:"âœ… Simular Pago (Testing)"})}),(0,a.jsx)("p",{className:"text-xs text-center text-gray-500",children:"El bot\xf3n verde es solo para pruebas. En producci\xf3n solo estar\xe1 el pago real."})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-4 text-gray-500",children:[(0,a.jsx)(m,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm",children:"Pago seguro"})]})]}),x&&(0,a.jsxs)("div",{className:"mt-6 bg-white rounded-2xl p-6 shadow-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Resumen de compra"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:x.title}),(0,a.jsx)("span",{className:"font-medium",children:V(x.priceCents,x.currency)})]}),x.validityDays&&(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Validez"}),(0,a.jsxs)("span",{className:"font-medium",children:[x.validityDays," d\xedas"]})]}),x.tipster&&(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Tipster"}),(0,a.jsx)("span",{className:"font-medium",children:x.tipster.publicName})]}),(0,a.jsxs)("div",{className:"border-t pt-3 flex justify-between",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:"Total"}),(0,a.jsx)("span",{className:"font-bold text-lg",children:V(x.priceCents,x.currency)})]})]})]})]})})}},1837:function(e,t,s){"use strict";s.d(t,{$z:function(){return c},Q4:function(){return l},fi:function(){return n},hi:function(){return a},iJ:function(){return r},kn:function(){return i},lY:function(){return o}});let a=s(3464).Z.create({baseURL:"https://4fe85d7a-ee67-4e48-a30d-728c1bd97a69.preview.emergentagent.com/api",withCredentials:!0,headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),a.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)!==401||["/login","/register","/"].includes(window.location.pathname)||(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(e)});let r={registerTipster:e=>a.post("/auth/tipster/register",e),registerClient:e=>a.post("/auth/client/register",e),login:e=>a.post("/auth/login",e),logout:()=>a.post("/auth/logout"),sendOtp:e=>a.post("/auth/otp/send",{email:e}),verifyOtp:e=>a.post("/auth/otp/verify",{code:e})},n={create:e=>a.post("/products",e),getMy:()=>a.get("/products/my"),getOne:e=>a.get("/products/".concat(e)),update:(e,t)=>a.patch("/products/".concat(e),t),publish:e=>a.post("/products/".concat(e,"/publish")),pause:e=>a.post("/products/".concat(e,"/pause")),getCheckoutLink:e=>a.get("/products/".concat(e,"/checkout-link"))},l={getLinks:()=>a.get("/referrals/links"),getMetrics:e=>a.get("/referrals/metrics",{params:{range:e}}),getCommissions:()=>a.get("/referrals/commissions")},c={getChannelInfo:()=>a.get("/telegram/channel-info"),connect:e=>a.post("/telegram/connect",{channelIdentifier:e}),disconnect:()=>a.delete("/telegram/disconnect"),publishProduct:e=>a.post("/products/".concat(e,"/publish-telegram")),setPremiumChannel:e=>a.post("/telegram/premium-channel",{premiumChannelLink:e}),channels:{getAll:()=>a.get("/telegram/channels"),getOne:e=>a.get("/telegram/channels/".concat(e)),create:e=>a.post("/telegram/channels",e),verify:e=>a.post("/telegram/channels/verify",{channelId:e}),update:(e,t)=>a.patch("/telegram/channels/".concat(e),t),delete:e=>a.delete("/telegram/channels/".concat(e)),refresh:e=>a.post("/telegram/channels/".concat(e,"/refresh")),generateInviteLink:e=>a.post("/telegram/channels/".concat(e,"/invite-link"))}},i={getMy:()=>a.get("/orders/my"),getMySales:()=>a.get("/orders/sales"),getMyStats:()=>a.get("/orders/stats")},o={getAll:()=>a.get("/settlements"),getPending:()=>a.get("/settlements/pending"),getHistory:()=>a.get("/settlements/history"),getTotalPaid:()=>a.get("/settlements/total-paid")}}},function(e){e.O(0,[301,971,117,744],function(){return e(e.s=4296)}),_N_E=e.O()}]);